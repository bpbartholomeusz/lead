define("local_booking/logbook",["exports","jquery","local_booking/jquery.dataTables","local_booking/dataTables.bootstrap4","core/notification","local_booking/repository","local_booking/booking_view_manager","local_booking/datatables"],(function(_exports,_jquery,_jquery2,_dataTables,_notification,Repository,ViewManager,_datatables){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * This module handles datatables for the logbook view.
   *
   * @module     local_booking/logbook
   * @author     Mustafa Hajjar (mustafahajjar@gmail.com)
   * @copyright  BAVirtual.co.uk Â© 2021
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_notification=_interopRequireDefault(_notification),Repository=_interopRequireWildcard(Repository),ViewManager=_interopRequireWildcard(ViewManager);_exports.init=root=>{ViewManager.startLoading(root);var courseId=(0,_jquery.default)(root).data("courseid"),userId=(0,_jquery.default)(root).data("userid"),logentries=[];return Repository.getPilotLogbook(courseId,userId).then((entries=>{entries.forEach((logentry=>{logentries.push([logentry.flightdate,logentry.depicao,logentry.deptime,logentry.arricao,logentry.arrtime,logentry.aircraft,void 0!==logentry.aircraftreg?logentry.aircraftreg:"","SE"==logentry.enginetype?"X":"","ME"==logentry.enginetype?"X":"",void 0!==logentry.multipilot?logentry.multipilot:"",logentry.flighttime,logentry.route,logentry.p1name,logentry.landingsday,logentry.landingsnight,logentry.nighttime,logentry.ifrtime,logentry.pictime,logentry.copilottime,logentry.dualtime,logentry.instructortime,void 0!==logentry.picustime?logentry.picustime:"",logentry.fstd,logentry.remarks])}));(0,_jquery.default)("#logbook").DataTable({data:logentries,order:[[0,"desc"]],lengthMenu:[[10,25,50,100,-1],[10,25,50,100,"All"]],columnDefs:[{width:"80px",targets:0},{width:"50px",targets:1},{width:"45px",targets:2},{width:"50px",targets:3},{width:"45px",targets:4},{width:"50px",targets:5},{width:"50px",targets:6},{width:"25px",className:"dt-center",targets:7},{width:"25px",className:"dt-center",targets:8},{width:"45px",targets:9},{width:"45px",targets:10},{width:"160px",targets:11},{width:"200px",targets:22},{width:"35px",className:"dt-center",targets:12},{width:"35px",className:"dt-center",targets:13},{width:"50px",targets:14},{width:"45px",targets:15},{width:"45px",targets:16},{width:"45px",targets:17},{width:"45px",targets:18},{width:"45px",targets:19},{width:"45px",targets:20},{width:"30px",targets:21},{width:"200px",targets:22}],footerCallback:function(row,data,start,end,display){var api=this.api(),intVal=function(i){return parseInt("string"==typeof i?parseInt(60*i.substring(0,i.indexOf(":")))+parseInt(i.substring(i.indexOf(":")+1,i.length)):"number"==typeof i?i:0)},multipilotTotal=api.column(9,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),grandTotal=api.column(10,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),daylandingsTotal=api.column(12,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),nightlandingsTotal=api.column(13,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),nightimeTotal=api.column(14,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),ifrtimeTotal=api.column(15,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),pictimeTotal=api.column(16,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),copilottimeTotal=api.column(17,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),dualtimeTotal=api.column(18,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),insttimeTotal=api.column(19,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),picustimeTotal=api.column(20,{page:"current"}).data().reduce((function(a,b){return intVal(a)+intVal(b)}),0),timeVal=function(i){var time=i;if(i>0){var hrs=parseInt(i/60),mins="00"+i%60;time=(hrs=hrs<10?("00"+hrs).substring(("00"+hrs).length,-2):hrs)+":"+mins.substring(mins.length-2)}return time};(0,_jquery.default)(api.column(9).footer()).html(0!=multipilotTotal?timeVal(multipilotTotal):""),(0,_jquery.default)(api.column(10).footer()).html(timeVal(grandTotal)),(0,_jquery.default)(api.column(12).footer()).html(0!=daylandingsTotal?daylandingsTotal:""),(0,_jquery.default)(api.column(13).footer()).html(0!=nightlandingsTotal?nightlandingsTotal:""),(0,_jquery.default)(api.column(14).footer()).html(0!=nightimeTotal?timeVal(nightimeTotal):""),(0,_jquery.default)(api.column(15).footer()).html(0!=ifrtimeTotal?timeVal(ifrtimeTotal):""),(0,_jquery.default)(api.column(16).footer()).html(0!=pictimeTotal?timeVal(pictimeTotal):""),(0,_jquery.default)(api.column(17).footer()).html(0!=copilottimeTotal?timeVal(copilottimeTotal):""),(0,_jquery.default)(api.column(18).footer()).html(0!=dualtimeTotal?timeVal(dualtimeTotal):""),(0,_jquery.default)(api.column(19).footer()).html(0!=insttimeTotal?timeVal(insttimeTotal):""),(0,_jquery.default)(api.column(20).footer()).html(0!=picustimeTotal?timeVal(picustimeTotal):"")},processing:!0})})).always((()=>{ViewManager.stopLoading(root)})).fail(_notification.default.exception)}}));

//# sourceMappingURL=logbook.min.js.map